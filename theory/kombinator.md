## Размещения, перестановки, сочетания (placement, permutation, combination)

```
ll factorial(ll b, ll a=1, ll mod=0)
{
    ll ans = 1; 
	for(ll i=a; i<=b; i++)
		if(mod==0) ans *= i;
        else ans = (ans*i) % mod;
	return ans;
}

ll binpow(ll a, ll n, ll m)
{
    if (n == 0)
        return 1 % m;

    if (n % 2 == 1)
        return (binpow(a, n - 1, m) * a) % m;
    else
        return binpow((a * a) % m, n / 2, m);
}

ll placement(ll k, ll n, ll mod=0)
{
    return factorial(n,n-k+1, mod);
}

ll placement_repeat(ll k, ll n, ll mod=0)
{
    return binpow(n,k, (mod==0?LLONG_MAX:mod));
}

ll permutation(ll n, ll mod=0)
{
    return factorial(n,1,mod);
}

ll permutation_repeat(vector<ll> v, ll mod=0)
{
    ll k = 0;
    for(auto d:v)
        k+=d;
    ll ans = factorial(k,1, mod), th = 1;
    
    for(auto d:v)
        th *= factorial(d,1,mod);
    
    if(mod==0)
        ans /= th;
    else ans = (ans/th)%mod;
    return ans;
}

ll combination(ll k, ll n, ll mod=0)
{
    return factorial(n,1,mod) / (factorial(n-k,1,mod) * factorial(k,1,mod));
}

ll combination_repeat(ll k, ll n, ll mod=0)
{
	if(n-1 > k)
		return factorial(n+k-1, n, mod) / factorial(k,1,mod);
	else
		return factorial(n+k-1, k+1, mod) / factorial(n-1, 1, mod); 
}
```

### Размещения без повторений из n элементов по k

A(k,n) = n!/(n-k)!

Пример: Определим количество таких трёхсимвольных слов в алфавите, состоящем из пяти символов, которые не содержат повторяющихся букв.

A(3,5) = 5!/(5-3)! = 60

### Размещения с повторениями из n элементов по k

A(-k,n) = n^k

Пример: Сколько пятизначных чисел можно составить из множества цифр {5,7,2}

A(-5,3) = 3^5 = 243

### Перестановки без повторений из n элементов

P(n) = n!

Пример: В морозилке лежат пять порций мороженого от различных фирм. Сколькими способами можно выбрать порядок их съедения?

P(5) = 5! = 120 

### Перестановки с повторениями

P(k) = k! / (k1!*k2!*...*kr!)
k = k1+k2+..+kr

Пример: Слова составляются на основе алфавита U={a,b,d}. Сколько различных слов из семи символов может быть составлено, если в этих словах буква "a" должна повторяться 2 раза; буква "b" – 1 раз, а буква "d" – 4 раза?

P(7) = 7! / (2!*1!*4!) = 105


### Сочетания без повторений из n элементов по k

C(k,n) = n! / ((n-k)!*k!)

Пример: В корзине размещены карточки, на которых написаны целые числа от 1 до 10. Из корзины вынимают 4 карточки. Сколько различных наборов карточек можно вытащить из корзины?

C(4,10) = 10! / ((10-4)!*4!) = 210

### Сочетания с повторениями из n элементов по k

C(-k,n) = (n+k-1)! / ((n-1)!*k!)

Пример: Представьте себе, что мы находимся на конфетном заводе, – прямо возле конвейера, по которому движутся конфеты четырёх сортов. Мы запускаем руки в этот поток и вытаскиваем двадцать штук. Сколько всего различных "конфетных комбинаций" может оказаться в горсти?

C(-20,4) = (4+20-1)! / ((4-1)!*20!) = 1771